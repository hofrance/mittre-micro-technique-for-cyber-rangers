# t1595.002s - vulnerability_scanning-web_application_scan-linux

## Overview
**Micro-technique for web application reconnaissance** using specialized web scanning techniques. Part of the **Reconnaissance (TA0043)** tactic in MITRE ATT&CK framework.

### Atomic Action
- **Single Observable Action**: Perform web application scanning ONLY
- **Web-Focused**: Optimized for web application discovery and enumeration
- **Multi-Tool Integration**: Combines Nmap, Gobuster, Dirb, and WhatWeb

### Contract Architecture
- **Get-Configuration**: Environment variable validation and setup
- **Precondition-Check**: Network environment and web tools validation
- **Atomic-Action**: web application scanning with comprehensive enumeration
- **Postcondition-Verify**: Results validation and cleanup

## Quick Start
```bash
# Basic web scanning
export t1595.002s_TARGETS="http://example.com"
export t1595.002s_OUTPUT_MODE="simple"
./src/main.sh

# Comprehensive web enumeration
export t1595.002s_OUTPUT_MODE="debug"
export t1595.002s_WORDLIST="/usr/share/wordlists/dirb/common.txt"
export t1595.002s_RECURSIVE_SCAN="true"
./src/main.sh

# Technology fingerprinting
export t1595.002s_TECHNOLOGY_DETECTION="true"
export t1595.002s_AGGRESSIVE_MODE="true"
./src/main.sh
```

## Environment Variables

### Core Configuration
- `t1595.002s_TARGETS`: Web targets (URLs/files) - **Required**
- `t1595.002s_OUTPUT_BASE`: Base output directory (default: /tmp/mitre_results)
- `t1595.002s_OUTPUT_MODE`: Output mode (simple/debug/stealth/silent) - default: simple
- `t1595.002s_SILENT_MODE`: Suppress all output (true/false) - default: false

### Web Scanning Configuration
- `t1595.002s_WEB_PORTS`: Web ports to scan (default: 80,443,8080,8443)
- `t1595.002s_USER_AGENT`: Custom User-Agent string
- `t1595.002s_TIMEOUT`: Request timeout (seconds) - default: 10
- `t1595.002s_THREADS`: Concurrent requests - default: 10
- `t1595.002s_FOLLOW_REDIRECTS`: Follow HTTP redirects (true/false) - default: true

### Content Discovery
- `t1595.002s_WORDLIST`: Path to wordlist file
- `t1595.002s_EXTENSIONS`: File extensions to test (php,asp,aspx,txt)
- `t1595.002s_RECURSIVE_SCAN`: Recursive directory scanning (true/false) - default: false
- `t1595.002s_MAX_DEPTH`: Maximum recursion depth - default: 3
- `t1595.002s_EXCLUDE_PATHS`: Paths to exclude from scanning

### Technology Detection
- `t1595.002s_TECHNOLOGY_DETECTION`: Enable tech fingerprinting (true/false) - default: true
- `t1595.002s_AGGRESSIVE_MODE`: Aggressive fingerprinting (true/false) - default: false
- `t1595.002s_PLUGIN_LIST`: Specific plugins to run
- `t1595.002s_CUSTOM_HEADERS`: Additional HTTP headers

### Advanced Options
- `t1595.002s_CUSTOM_FLAGS`: Additional tool flags
- `t1595.002s_PROXY`: HTTP proxy configuration
- `t1595.002s_AUTH_CREDENTIALS`: Basic auth credentials (user:pass)
- `t1595.002s_COOKIES`: Custom cookies for authenticated scanning

## Output Modes

### Simple Mode (Default)
Human-readable web scan results:
```
[INFO] Web web application scan started
[INFO] Targets: http://example.com
[INFO] Found 45 directories, 12 files, 8 technologies
[INFO] Results saved to: /tmp/mitre_results/t1595.002s_results.json
```

### Debug Mode
Detailed technical information with all tool outputs:
```
[DEBUG] Nmap command: nmap -p 80,443 --script=http* http://example.com
[DEBUG] Gobuster command: gobuster dir -u http://example.com -w /usr/share/wordlists/common.txt
[DEBUG] Technologies detected: Apache, PHP, WordPress
[DEBUG] Generated: web_results.json, nmap_output.xml, gobuster_output.txt
```

### Stealth Mode
Minimal output for covert operations:
```
[STEALTH] Operation completed - check results directory
```

### Silent Mode
No console output whatsoever (completely silent execution).

## Output Files

### JSON Results (`web_results.json`)
```json
{
  "technique_id": "t1595.002s",
  "technique_name": "vulnerability_scanning-web_application_scan-linux",
  "scan_timestamp": "2024-01-15T10:30:00Z",
  "scan_type": "web application",
  "configuration": {
    "targets": "${t1595.002s_TARGETS}",
    "wordlist": "${t1595.002s_WORDLIST}",
    "recursive_scan": ${t1595.002s_RECURSIVE_SCAN}
  },
  "results": {
    "directories_found": 45,
    "files_found": 12,
    "technologies_detected": 8,
    "scan_duration_seconds": 125.3
  },
  "findings": {
    "directories": [
      {
        "path": "/admin",
        "status": 200,
        "size": 1024,
        "content_type": "text/html"
      }
    ],
    "technologies": [
      {
        "name": "Apache",
        "version": "2.4.41",
        "categories": ["Web Server"]
      }
    ]
  }
}
```

### Technical Details (`nmap_output.xml`)
Complete Nmap web scan results with all detected services and scripts.

### Directory Enumeration (`gobuster_output.txt`)
Detailed directory and file discovery results from Gobuster.

### Technology Report (`whatweb_output.txt`)
Web technology fingerprinting results from WhatWeb.

## Examples

### Basic Web Content Discovery
```bash
export t1595.002s_TARGETS="http://example.com"
export t1595.002s_WORDLIST="/usr/share/wordlists/dirb/common.txt"
export t1595.002s_OUTPUT_MODE="simple"
./src/main.sh
```

### Comprehensive Web Application Mapping
```bash
export t1595.002s_TARGETS="https://example.com"
export t1595.002s_RECURSIVE_SCAN="true"
export t1595.002s_EXTENSIONS="php,asp,aspx,jsp"
export t1595.002s_TECHNOLOGY_DETECTION="true"
export t1595.002s_OUTPUT_MODE="debug"
./src/main.sh
```

### Authenticated Web Scanning
```bash
export t1595.002s_TARGETS="https://internal.company.com"
export t1595.002s_AUTH_CREDENTIALS="admin:password123"
export t1595.002s_COOKIES="session=abc123def456"
export t1595.002s_OUTPUT_MODE="stealth"
./src/main.sh
```

## Security Considerations

### Web Scanning Risks
- **Detection**: Web scanning is easily detectable by WAF and IDS
- **Legal Compliance**: Ensure authorization for web application scanning
- **Resource Impact**: Aggressive scanning may affect target performance
- **Data Exposure**: Directory enumeration may reveal sensitive paths

### Operational Security
- **Rate Limiting**: Respect target resources with appropriate delays
- **User-Agent Rotation**: Use realistic browser user agents
- **Session Management**: Handle authentication properly
- **Log Analysis**: Review target logs for scan detection

## Error Handling

### Return Codes
- `0`: Success - Web scan completed successfully
- `1`: Configuration Error - Invalid environment variables
- `2`: Precondition Failed - Network/tools not available
- `3`: Execution Error - Web scan failed during execution
- `4`: Postcondition Error - Results validation failed
- `124`: Timeout - Operation exceeded time limits
- `130`: User Interrupt - Operation cancelled by user

### Common Issues
```bash
# Wordlist not found
export t1595.002s_WORDLIST="/nonexistent/wordlist.txt"
./src/main.sh
# Returns: 1 (Configuration Error)

# Target unreachable
export t1595.002s_TARGETS="http://192.0.2.1"  # RFC 5737 test range
./src/main.sh
# Returns: 2 (Precondition Failed)

# Authentication required
export t1595.002s_TARGETS="https://protected-site.com"
./src/main.sh
# Returns: 2 (Precondition Failed) - No credentials provided
```

## Dependencies

### Required Tools
- **nmap**: 7.0+ (Web service detection and NSE scripts)
- **gobuster**: 3.0+ (Directory and file enumeration)
- **dirb**: 2.2+ (Web content scanner)
- **whatweb**: 0.5+ (Web technology fingerprinting)
- **bash**: 4.0+ (Script execution environment)

### Optional Enhancements
- **nikto**: Web server scanner for vulnerability assessment
- **wpscan**: WordPress vulnerability scanner
- **joomlavs**: Joomla vulnerability scanner
- **drupalscan**: Drupal vulnerability scanner

## Architecture Details

### Contract Functions
1. **Get-Configuration**: Validate and load environment variables
2. **Precondition-Check**: Verify network access and web tools
3. **Atomic-Action**: Execute web scanning with multiple tools
4. **Postcondition-Verify**: Validate results and cleanup

### Tool Integration
```
Targets → Nmap Web Detection → Gobuster Directory Scan
                        ↓
              Dirb Content Scan → WhatWeb Tech Detection
                        ↓
              Results Consolidation → Standardized Output
```

## Contributing
This micro-technique follows standards for:
- Atomic decomposition of adversarial behaviors
- Standardized environment variable patterns
- Contract-driven architecture
- Multi-modal output capabilities

