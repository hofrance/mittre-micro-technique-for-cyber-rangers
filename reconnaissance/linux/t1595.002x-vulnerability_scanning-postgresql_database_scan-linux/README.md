# t1595.002x - vulnerability_scanning-postgresql_database_scan

## Overview
**Micro-technique for PostgreSQL Database Discovery reconnaissance** using specialized scanning techniques. Part of the **Reconnaissance (TA0043)** tactic in MITRE ATT&CK framework.

### Atomic Action
- **Single Observable Action**: Perform PostgreSQL Database Discovery scanning ONLY
- **Specialized**: Optimized for Database Scanning environment
- **Comprehensive**: Full service detection and enumeration

### Contract Architecture
- **Get-Configuration**: Environment variable validation and setup
- **Precondition-Check**: Network environment and tool validation
- **Atomic-Action**: PostgreSQL Database Discovery scanning execution
- **Postcondition-Verify**: Results validation and cleanup

## Quick Start
```bash
# Basic PostgreSQL Database Discovery scan
export t1595.002x_TARGETS="192.168.1.0/24"
export t1595.002x_OUTPUT_MODE="simple"
./src/main.sh

# Advanced PostgreSQL Database Discovery enumeration
export t1595.002x_OUTPUT_MODE="debug"
export t1595.002x_VERSION_DETECTION="true"
./src/main.sh
```

## Environment Variables

### Core Configuration
- `t1595.002x_TARGETS`: Target specification (IP/range/file) - **Required**
- `t1595.002x_OUTPUT_BASE`: Base output directory (default: /tmp/mitre_results)
- `t1595.002x_OUTPUT_MODE`: Output mode (simple/debug/stealth/silent) - default: simple
- `t1595.002x_SILENT_MODE`: Suppress all output (true/false) - default: false

### Specialized Configuration
- `t1595.002x_SERVICE_DETECTION`: Enable service detection (true/false) - default: true
- `t1595.002x_VERSION_DETECTION`: Enable version detection (true/false) - default: true
- `t1595.002x_TIMING_TEMPLATE`: Nmap timing (normal/aggressive) - default: normal
- `t1595.002x_RATE_LIMIT`: Packets per second limit (0=unlimited) - default: 10

## Output Modes

### Simple Mode (Default)
Human-readable scan results:
```
[INFO] PostgreSQL Database Discovery scan started
[INFO] Targets: 192.168.1.0/24
[INFO] Found 8 services, 5 with version info
[INFO] Results saved to: /tmp/mitre_results/t1595.002x_results.json
```

### Debug Mode
Detailed technical information:
```
[DEBUG] Nmap command: nmap -sV -p 5432 -sV -T3
[DEBUG] Scan duration: 45.2 seconds
[DEBUG] Services detected: 8
[DEBUG] Generated: scan_results.json, technical_details.xml
```

